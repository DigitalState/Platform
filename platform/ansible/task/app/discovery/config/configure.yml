---
- block:
    - name: Configure discovery store key-value data
      include_role:
        name: app/discovery/config/configure
      vars:
        _data:
          '{{ namespace }}/services/assets/host': '{{ app.assets.api.host }}'
          '{{ namespace }}/services/assets/enabled': '{{ app.assets.enabled }}'
          '{{ namespace }}/services/assets/attributes/access': 'True'
          '{{ namespace }}/services/assets/attributes/tenant': 'True'
          '{{ namespace }}/services/authentication/host': '{{ app.authentication.api.host }}'
          '{{ namespace }}/services/authentication/enabled': '{{ app.authentication.enabled }}'
          '{{ namespace }}/services/authentication/attributes/access': 'True'
          '{{ namespace }}/services/authentication/attributes/tenant': 'True'
          '{{ namespace }}/services/camunda/host': '{{ app.camunda.api.host }}/engine-rest'
          '{{ namespace }}/services/camunda/enabled': '{{ app.camunda.enabled }}'
          '{{ namespace }}/services/cases/host': '{{ app.cases.api.host }}'
          '{{ namespace }}/services/cases/enabled': '{{ app.cases.enabled }}'
          '{{ namespace }}/services/cases/attributes/access': 'True'
          '{{ namespace }}/services/cases/attributes/tenant': 'True'
          '{{ namespace }}/services/cms/host': '{{ app.cms.api.host }}'
          '{{ namespace }}/services/cms/enabled': '{{ app.cms.enabled }}'
          '{{ namespace }}/services/cms/attributes/access': 'True'
          '{{ namespace }}/services/cms/attributes/tenant': 'True'
          '{{ namespace }}/services/formio/host': '{{ app.formio.api.host }}'
          '{{ namespace }}/services/formio/enabled': '{{ app.formio.enabled }}'
          '{{ namespace }}/services/forms/host': '{{ app.forms.api.host }}'
          '{{ namespace }}/services/forms/enabled': '{{ app.forms.enabled }}'
          '{{ namespace }}/services/forms/attributes/access': 'True'
          '{{ namespace }}/services/forms/attributes/tenant': 'True'
          '{{ namespace }}/services/identities/host': '{{ app.identities.api.host }}'
          '{{ namespace }}/services/identities/enabled': '{{ app.identities.enabled }}'
          '{{ namespace }}/services/identities/attributes/access': 'True'
          '{{ namespace }}/services/identities/attributes/tenant': 'True'
          '{{ namespace }}/services/interactions/host': '{{ app.interactions.api.host }}'
          '{{ namespace }}/services/interactions/enabled': '{{ app.interactions.enabled }}'
          '{{ namespace }}/services/interactions/attributes/access': 'True'
          '{{ namespace }}/services/interactions/attributes/tenant': 'True'
          '{{ namespace }}/services/logs/host': '{{ app.logs.api.host }}'
          '{{ namespace }}/services/logs/enabled': '{{ app.logs.enabled }}'
          '{{ namespace }}/services/records/host': '{{ app.records.api.host }}'
          '{{ namespace }}/services/records/enabled': '{{ app.records.enabled }}'
          '{{ namespace }}/services/records/attributes/access': 'True'
          '{{ namespace }}/services/records/attributes/tenant': 'True'
          '{{ namespace }}/services/services/host': '{{ app.services.api.host }}'
          '{{ namespace }}/services/services/enabled': '{{ app.services.enabled }}'
          '{{ namespace }}/services/services/attributes/access': 'True'
          '{{ namespace }}/services/services/attributes/tenant': 'True'
          '{{ namespace }}/services/tasks/host': '{{ app.tasks.api.host }}'
          '{{ namespace }}/services/tasks/enabled': '{{ app.tasks.enabled }}'
          '{{ namespace }}/services/tasks/attributes/access': 'True'
          '{{ namespace }}/services/tasks/attributes/tenant': 'True'
          '{{ namespace }}/services/tenants/host': '{{ app.tenants.api.host }}'
          '{{ namespace }}/services/tenants/enabled': '{{ app.tenants.enabled }}'
          '{{ namespace }}/services/tenants/attributes/access': 'True'
          '{{ namespace }}/services/tenants/attributes/tenant': 'True'
          '{{ namespace }}/services/topics/host': '{{ app.topics.api.host }}'
          '{{ namespace }}/services/topics/enabled': '{{ app.topics.enabled }}'
          '{{ namespace }}/services/topics/attributes/access': 'True'
          '{{ namespace }}/services/topics/attributes/tenant': 'True'
        _credential: '{{ app.discovery.token.master }}'
  when: app.discovery.enabled
  tags: [discovery]
